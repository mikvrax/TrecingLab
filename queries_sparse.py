#!/usr/bin/python3

import pyndri

index = pyndri.Index("FinalIndex")

tokens, ids, df = index.get_dictionary()
tf = index.get_term_frequencies()

del ids
del df
f = open("queries_training_set.txt","r")
l = f.readlines()
f.close()

f = open("sparse3.txt","r")
r = f.readlines()
f.close()
t = []

e = max(tf.keys())
#s = {}
p ={}

o = open("sparse_rep4.txt","w")

for i in range(0,len(r)):
    a = r[i].split("\n")
    t.append(a[0])

k = tokens.keys()
#v = tokens.values()

#for i in range(0,len(k)):
#    s[k[i]] = v[i]

y = 0
del r

#336890
#a1 = [2,15108,45465,15093,30914, 15095, 146962, 15106, 33431, 19790,31839,60443,70155,160212, 28541,56840, 87492, 28915,64783,28948,87484, 29001,33386,33487,  40431,53320,64857, 90526, 29589,160207,30914, 15093, 31812, 33395,31836, 33490, 56857, 31836, 63855,67965,87494,129870,  129884, 132383, 143131, 169271,19790,31839 ,60443, 70155,160212, 29001,33386 ,33487, 40431, 53320,64857,33395,31812 , 33431 ,15106,33487 ,29001, 33386, 40431,53320, 64857 ,33490 ,31836,56857,63855, 67965, 87494,129870, 129884,132383,143131,169271,33505, 47374, 160214,39983,65535,  40431, 29001, 33386,33487, 53320, 64857,42581,56884,47368, 169276,47374,33505,160214,47384,56860, 52286, 65559,29001,53320 ,33386, 33487, 40431, 64857,56840,28541,56840,87492,56857,31836,56857,33490,56857,63855,56857,67965,56857,87494,56857,129870,56857,129884,56857,132383,56857,143131,56857,169271,56860,47384,56884,42581,60443,19790,60443,31839,60443,70155,60443,160212,63855,31836,63855,33490,63855,56857,63855,67965,63855,87494,63855,129870,63855,129884,63855,132383,63855, 143131,63855,169271,64783,28915,64857,29001,64857,33386,64857,33487,64857,40431,64857,53320,65535,39983,65559,52286,67965,31836,67965,33490,67965,56857,67965,63855,67965,87494,67965,129870,67965,129884,67965,132383,67965,143131,67965,169271,67969,75248,67974,92567,69254,159946,70155,19790,70155,31839,70155,60443,70155,160212,70749,85737,75248,67969,85737,70749,87478,159967,87484,28948,87492,28541,87492,56840,87494,31836,87494,33490,87494,56857,87494,63855,87494,67965,87494,129870,87494,129884,87494,132383,87494,143131,87494,169271,87540,91774,90526,29589,90526,160207,91774,87540,92567,67974,129870,31836,129870,33490,129870,56857,129870,63855,129870,67965,129870,87494,129870,129884,129870,132383,129870,143131,129870,169271,129884,31836,129884,33490,129884,56857,129884,63855,129884,67965,129884,87494,129884,129870,129884,132383,129884,143131,129884,169271,132383,31836,132383,33490,132383,56857,132383,63855,132383,67965,132383,87494,132383,129870,132383,129884,132383,143131,132383,169271,143131,31836,143131,33490,143131,56857,143131,63855,143131,67965,143131,87494,143131,129870,143131,129884,143131,132383,143131,169271,146962,15095,159946,69254,159967,87478,160207,29589,160207,90526,160212,19790,160212,31839,160212,60443,160212,70155,160214,33505,160214,47374,169271,31836,169271,33490,169271,56857,169271,63855,169271,67965,169271,87494,169271,129870,169271,129884,169271,132383,169271,143131,169276, 47368]

#b1=set(a1)
#c1 = list(b1)

r = len(l)
for i in range(336890):
    y = 0
    for z in range(0,e):
        p[z+1] = 0 
    a = l[0].split("\n")
    del l[0]
    b = a[0].split(" ") 
    for j in b:
        if (j in t):
           p[e+t.index(j)+1] = b.count(j)
        else:
           p[tokens[j]] = b.count(j)
    for z in range(0,e):
        if p[z+1] == 0:
            y += 1
        else:
            o.write("0"+","+str(y)+","+str(p[z+1])+",")
            y = 0
    o.write("\n")

   
o.close()
